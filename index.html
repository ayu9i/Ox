<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XO SUPREME FINAL</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #020617; --panel: #1e293b; --accent: #38bdf8; --text: #f8fafc; --gold: #fbbf24; }
        body { font-family: 'Kanit', sans-serif; background: var(--bg); color: var(--text); text-align: center; margin: 0; padding: 10px; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .container { width: 100%; max-width: 400px; background: var(--panel); padding: 25px; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.5); border: 1px solid #334155; }
        .coin-box { font-size: 2.5rem; color: var(--gold); font-weight: bold; margin-bottom: 15px; }
        .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 20px 0; }
        .cell { aspect-ratio: 1/1; background: #0f172a; border: 2px solid #334155; border-radius: 15px; font-size: 2.5rem; color: white; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; }
        .cell:hover { border-color: var(--accent); background: #1e293b; }
        .btn { background: linear-gradient(45deg, #0ea5e9, #6366f1); color: white; border: none; padding: 15px; border-radius: 15px; width: 100%; font-weight: bold; cursor: pointer; font-size: 1rem; margin-top: 10px; }
        .shop { display: flex; gap: 10px; margin-bottom: 15px; }
        .shop-item { flex: 1; background: #334155; border: none; color: white; padding: 10px; border-radius: 10px; font-size: 0.75rem; cursor: pointer; }
        .shop-item:disabled { opacity: 0.5; cursor: not-allowed; }
        input { width: 90%; padding: 12px; border-radius: 10px; border: none; margin-bottom: 10px; background: #0f172a; color: white; text-align: center; }
        .leaderboard { text-align: left; margin-top: 20px; padding: 15px; background: #0f172a; border-radius: 15px; font-size: 0.85rem; border: 1px solid #334155; }
    </style>
</head>
<body>

<div class="container">
    <div id="login-part">
        <h1 style="color: var(--accent); margin-bottom: 5px;">XO SUPREME</h1>
        <p style="font-size: 0.8rem; opacity: 0.7;">‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡∏Ñ‡πÇ‡∏Ñ‡πâ‡∏î‡∏´‡∏•‡∏∏‡∏î 100%</p>
        <input type="text" id="nameInp" placeholder="‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ó‡πà‡πÜ ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
        <button class="btn" onclick="goPlay()">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡∏≥‡∏ô‡∏≤‡∏ô</button>
    </div>

    <div id="game-part" style="display:none;">
        <div class="coin-box">ü™ô <span id="c-count">0</span></div>
        <div id="u-tag" style="color: var(--accent); font-weight: bold; margin-bottom: 10px;"></div>
        
        <div class="shop">
            <button class="shop-item" onclick="buy('rem')">üßπ ‡∏•‡∏ö O AI<br>(100ü™ô)</button>
            <button class="shop-item" id="x2-btn" onclick="buy('x2')">‚úñÔ∏è ‡∏ä‡∏ô‡∏∞ x2<br>(50ü™ô)</button>
        </div>

        <div class="board" id="main-board"></div>
        
        <button class="btn" onclick="re()">‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô</button>

        <div class="leaderboard">
            <b style="color: var(--gold);">üèÜ TOP RANKING</b>
            <div id="lb-view" style="margin-top:5px;"></div>
        </div>
    </div>
</div>

<script>
    // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
    let c = parseInt(localStorage.getItem('xo_c')) || 0;
    let u = localStorage.getItem('xo_u') || '';
    let b = Array(9).fill('');
    let active = true;
    let isX2 = false;

    function goPlay() {
        let val = document.getElementById('nameInp').value || u;
        if(val) {
            u = val; localStorage.setItem('xo_u', u);
            document.getElementById('login-part').style.display = 'none';
            document.getElementById('game-part').style.display = 'block';
            document.getElementById('u-tag').innerText = "PLAYER: " + u;
            draw();
        }
    }

    function draw() {
        const grid = document.getElementById('main-board');
        grid.innerHTML = '';
        b.forEach((v, i) => {
            const div = document.createElement('div');
            div.className = 'cell';
            div.innerText = v;
            div.onclick = () => tap(i);
            grid.appendChild(div);
        });
        document.getElementById('c-count').innerText = c.toLocaleString();
        updateLB();
    }

    function tap(i) {
        if(b[i] === '' && active) {
            b[i] = 'X'; draw();
            if(win('X')) { finish('X'); }
            else if(b.every(s => s !== '')) { finish('T'); }
            else { active = false; setTimeout(ai, 500); }
        }
    }

    function ai() {
        let empty = b.map((v,i) => v==='' ? i : null).filter(v => v!==null);
        if(empty.length > 0) {
            let move = empty[Math.floor(Math.random() * empty.length)];
            b[move] = 'O';
            if(win('O')) finish('O');
            else if(b.every(s => s !== '')) finish('T');
        }
        active = true; draw();
    }

    function buy(t) {
        if(t === 'rem' && c >= 100) {
            let o = b.map((v,i) => v==='O' ? i : null).filter(v => v!==null);
            if(o.length > 0) { c -= 100; b[o[0]] = ''; draw(); }
        } else if(t === 'x2' && c >= 50) {
            c -= 50; isX2 = true;
            document.getElementById('x2-btn').innerText = "‚úÖ ACTIVE";
            document.getElementById('x2-btn').disabled = true;
            draw();
        } else { alert("‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠!"); }
    }

    function finish(res) {
        active = false;
        if(res === 'X') {
            let p = isX2 ? 100 : 50; c += p;
            alert("‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞! +" + p + " ü™ô");
        } else if(res === 'O') { alert("AI ‡∏ä‡∏ô‡∏∞!"); }
        else { alert("‡πÄ‡∏™‡∏°‡∏≠!"); }
        
        isX2 = false;
        document.getElementById('x2-btn').innerText = "‚úñÔ∏è ‡∏ä‡∏ô‡∏∞ x2 (50ü™ô)";
        document.getElementById('x2-btn').disabled = false;
        localStorage.setItem('xo_c', c);
        re();
    }

    function win(p) {
        const lines = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
        return lines.some(l => l.every(i => b[i] === p));
    }

    function updateLB() {
        let list = JSON.parse(localStorage.getItem('xo_lb')) || [];
        let f = list.findIndex(x => x.n === u);
        if(f > -1) list[f].c = c; else if(u) list.push({n: u, c: c});
        list.sort((x,y) => y.c - x.c);
        localStorage.setItem('xo_lb', JSON.stringify(list));
        document.getElementById('lb-view').innerHTML = list.slice(0,3).map((p,i) => `<div>${i+1}. ${p.n}: ${p.c}</div>`).join('');
    }

    function re() { b = Array(9).fill(''); active = true; draw(); }
    if(u) goPlay();
</script>

</body>
</html>
