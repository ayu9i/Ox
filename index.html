<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AYU GAME ZONE: ULTIMATE</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&family=Orbitron:wght@400;900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --bg: #020617; --cyan: #22d3ee; --pink: #f43f5e; --gold: #fbbf24;
            --green: #10b981; --red: #ef4444; --glass: rgba(15, 23, 42, 0.9);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; font-family: 'Kanit', sans-serif; }
        body {
            background: var(--bg); color: white; margin: 0; padding: 10px;
            display: flex; justify-content: center; min-height: 100vh;
            background: radial-gradient(circle at 50% 50%, #1e1b4b 0%, #020617 100%);
        }
        .container {
            width: 100%; max-width: 480px; background: var(--glass);
            backdrop-filter: blur(20px); border-radius: 30px; padding: 20px;
            border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        /* Stats Panel */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-family: 'Orbitron'; font-size: 0.7rem; }
        .stats-panel { background: rgba(0,0,0,0.3); padding: 12px; border-radius: 20px; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.05); }
        .level-row { display: flex; justify-content: space-between; font-family: 'Orbitron'; font-size: 0.8rem; color: var(--cyan); margin-bottom: 5px; }
        .exp-track { width: 100%; height: 6px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; }
        .exp-fill { height: 100%; background: linear-gradient(90deg, var(--cyan), #818cf8); width: 0%; transition: 0.5s; }
        .coin-box { font-size: 2.2rem; color: var(--gold); font-weight: bold; font-family: 'Orbitron'; text-align: center; margin: 10px 0; text-shadow: 0 0 10px rgba(251,191,36,0.3); }

        /* Redeem Code UI */
        .redeem-section { background: rgba(251, 191, 36, 0.1); padding: 10px; border-radius: 15px; border: 1px dashed var(--gold); margin-bottom: 15px; }
        .redeem-row { display: flex; gap: 8px; }

        /* Skin Shop */
        .shop-container { display: flex; gap: 10px; overflow-x: auto; padding: 10px 0; margin-bottom: 15px; scrollbar-width: none; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .skin-card { min-width: 85px; background: rgba(255,255,255,0.05); border-radius: 15px; padding: 10px; text-align: center; border: 1px solid transparent; cursor: pointer; transition: 0.3s; }
        .skin-card.active { border-color: var(--cyan); background: rgba(34, 211, 238, 0.1); }
        .skin-icon { font-size: 1.5rem; display: block; margin-bottom: 5px; }
        .skin-price { font-size: 0.65rem; color: var(--gold); font-family: 'Orbitron'; }

        /* Leaderboard & Chat */
        .leaderboard { background: rgba(0,0,0,0.2); border-radius: 15px; padding: 10px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .lb-title { font-family: 'Orbitron'; color: var(--gold); font-size: 0.75rem; text-align: center; margin-bottom: 8px; }
        .lb-item { display: flex; justify-content: space-between; font-size: 0.75rem; padding: 4px 8px; background: rgba(0,0,0,0.2); margin-bottom: 4px; border-radius: 6px; }

        .chat-box { background: rgba(0,0,0,0.4); border-radius: 12px; height: 100px; overflow-y: auto; padding: 10px; font-size: 0.75rem; border: 1px solid rgba(255,255,255,0.05); margin-bottom: 10px; }
        
        /* Game Board */
        .board { display: grid; gap: 8px; background: rgba(0,0,0,0.3); padding: 12px; border-radius: 20px; margin: 10px 0; border: 1px solid rgba(255,255,255,0.05); }
        .cell { aspect-ratio: 1/1; background: rgba(30, 41, 59, 0.7); border-radius: 12px; font-size: 2.2rem; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; border: 1px solid rgba(255,255,255,0.03); }
        .cell:active { transform: scale(0.95); }

        /* Controls */
        .btn { font-family: 'Orbitron'; background: linear-gradient(90deg, #0ea5e9, #6366f1); color: white; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 5px; }
        .btn-red { background: linear-gradient(90deg, #f43f5e, #be123c); }
        input, select { background: rgba(0,0,0,0.5); border: 1px solid #334155; color: white; padding: 12px; border-radius: 12px; width: 100%; margin-bottom: 8px; }

        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 30px; text-align: center; }
    </style>
</head>
<body>

<div id="login-overlay">
    <h1 style="font-family:'Orbitron'; color:var(--cyan); margin-bottom: 0; font-size: 2.2rem;">AYU GAME ZONE</h1>
    <p style="opacity:0.5; font-size:0.7rem; margin-bottom:40px; letter-spacing:3px;">THE ULTIMATE VERSION</p>
    <div style="width: 100%; max-width: 320px;">
        <input type="text" id="pNameInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì...">
        <button class="btn" onclick="startApp()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏° (CONNECT)</button>
    </div>
</div>

<div class="container">
    <div id="game-ui" style="display:none">
        <div class="top-bar">
            <div><span id="ping-val">24</span>ms <div style="width:8px; height:8px; border-radius:50%; background:var(--green); display:inline-block;"></div></div>
            <div id="display-name" style="color:var(--cyan)">PLAYER</div>
        </div>

        <div class="stats-panel">
            <div class="level-row"><span id="lvl-txt">LVL 1</span><span id="exp-txt">0/500</span></div>
            <div class="exp-track"><div id="exp-fill" class="exp-fill"></div></div>
        </div>

        <div class="coin-box">ü™ô <span id="coin-txt">0</span></div>

        <div class="redeem-section">
            <div style="font-size: 0.7rem; color: var(--gold); margin-bottom: 5px; font-weight: bold;">REDEEM CODE (20 CODES AVAILABLE)</div>
            <div class="redeem-row">
                <input type="text" id="code-input" placeholder="‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..." style="margin:0; padding:8px;">
                <button class="btn" style="width:80px; margin:0; padding:0; font-size:0.7rem;" onclick="redeemCode()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
            </div>
        </div>

        <div class="shop-container" id="skin-shop"></div>

        <div class="leaderboard">
            <div class="lb-title">GOD TIER RANKING</div>
            <div id="lb-content"></div>
        </div>

        <div class="chat-box" id="chat-content"></div>
        <div style="display:flex; gap:5px; margin-bottom:15px;">
            <input type="text" id="chat-input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." style="margin:0; padding:10px;">
            <button class="btn" style="width:60px; margin:0; padding:0;" onclick="sendChat()">‚û§</button>
        </div>

        <select id="diff-mode" onchange="addChatSys('‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏Å‡πÅ‡∏•‡πâ‡∏ß')">
            <option value="easy">‡∏á‡πà‡∏≤‡∏¢ (0 ü™ô)</option>
            <option value="normal">‡∏õ‡∏Å‡∏ï‡∏¥ (0 ü™ô)</option>
            <option value="hard" selected>‡∏û‡∏£‡∏∞‡πÄ‡∏à‡πâ‡∏≤ (200 ü™ô)</option>
        </select>
        
        <select id="size-mode" onchange="initBoard()">
            <option value="3">3X3 ‡∏Ñ‡∏•‡∏≤‡∏™‡∏™‡∏¥‡∏Å</option>
            <option value="5">5X5 ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á</option>
        </select>

        <div id="grid" class="board"></div>
        <button class="btn btn-red" onclick="matchmake()">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÉ‡∏´‡∏°‡πà</button>
    </div>
</div>

<script>
    /* --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡πâ‡∏î --- */
    let player = JSON.parse(localStorage.getItem('ayu_final_db')) || {
        name: '', coins: 0, exp: 0, lvl: 1, wins: 0,
        skins: ['Default'], activeSkin: 'Default', usedCodes: []
    };

    // ‡∏£‡∏∞‡∏ö‡∏ö 20 ‡πÇ‡∏Ñ‡πâ‡∏î‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
    const secretCodes = {
        'AYU666': 666, 'FREECOIN': 100, 'GODMODE': 1000, 'WELCOME': 500, 'LUCKY7': 777,
        'KINGXO': 300, 'OPPONENT': 200, 'NEONLIGHT': 450, 'AYUZONE': 888, 'RICHMAN': 2000,
        'DEVAYU': 999, 'XOMASTER': 150, 'LEGEND': 1200, 'SUPREME': 600, 'GIFT4U': 400,
        'COIN99': 99, 'ELITE': 350, 'CHAMPION': 700, 'MYCODE': 500, 'HACKER': 1
    };

    const skins = [
        { id: 'Default', icon: '‚ùå', price: 0 },
        { id: 'Neon', icon: 'üíé', price: 500 },
        { id: 'Fire', icon: 'üî•', price: 1500 },
        { id: 'God', icon: 'üëë', price: 5000 }
    ];

    let board = [];
    let gameActive = false;

    function startApp() {
        let name = document.getElementById('pNameInput').value.trim();
        if(!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠!");
        player.name = name;
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('game-ui').style.display = 'block';
        document.getElementById('display-name').innerText = name.toUpperCase();
        save(); updateUI(); initBoard();
        addChatSys("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì " + name);
    }

    function redeemCode() {
        let code = document.getElementById('code-input').value.trim().toUpperCase();
        if(!code) return;
        if(player.usedCodes.includes(code)) return alert("‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß!");
        if(secretCodes[code]) {
            let gift = secretCodes[code];
            player.coins += gift;
            player.usedCodes.push(code);
            confetti();
            alert("‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " + gift + " ü™ô");
            document.getElementById('code-input').value = '';
            updateUI(); save();
        } else {
            alert("‡πÇ‡∏Ñ‡πâ‡∏î‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        }
    }

    function initBoard() {
        let s = parseInt(document.getElementById('size-mode').value);
        board = Array(s*s).fill('');
        document.getElementById('grid').style.gridTemplateColumns = `repeat(${s}, 1fr)`;
        render();
    }

    function render() {
        const grid = document.getElementById('grid'); grid.innerHTML = '';
        const skinIcon = skins.find(s => s.id === player.activeSkin).icon;
        board.forEach((v, i) => {
            const cell = document.createElement('div');
            cell.className = 'cell';
            if(v==='X') { cell.innerText = skinIcon; cell.style.color = 'var(--cyan)'; }
            else if(v==='O') { cell.innerText = '‚≠ï'; cell.style.color = 'var(--pink)'; }
            cell.onclick = () => tap(i);
            grid.appendChild(cell);
        });
    }

    function tap(i) {
        if(!gameActive || board[i]!=='') return;
        board[i] = 'X'; render();
        if(checkWin('X')) return end('win');
        if(board.every(b => b!=='')) return end('draw');
        gameActive = false; setTimeout(bot, 600);
    }

    function bot() {
        let empty = board.map((v,i)=>v===''?i:null).filter(v=>v!==null);
        let diff = document.getElementById('diff-mode').value;
        let move;
        if(diff==='hard') move = find('O') || find('X') || empty[0];
        else move = empty[Math.floor(Math.random()*empty.length)];
        
        board[move] = 'O'; render();
        if(checkWin('O')) return end('lose');
        if(board.every(b => b!=='')) return end('draw');
        gameActive = true;
    }

    function find(p) {
        for(let i=0; i<board.length; i++) {
            if(board[i]==='') { board[i]=p; if(checkWin(p)) { board[i]=''; return i; } board[i]=''; }
        } return null;
    }

    function checkWin(p) {
        let s = parseInt(document.getElementById('size-mode').value);
        let winN = s === 3 ? 3 : 4;
        for(let i=0; i<board.length; i++) {
            if(board[i]===p) {
                if(line(i,1,winN,p,s)||line(i,s,winN,p,s)||line(i,s+1,winN,p,s)||line(i,s-1,winN,p,s)) return true;
            }
        } return false;
    }

    function line(idx, step, target, p, s) {
        for(let k=0; k<target; k++) {
            let n = idx + k*step;
            if(n<0 || n>=board.length || board[n]!==p) return false;
            if(step===1 && Math.floor(n/s) !== Math.floor(idx/s)) return false;
        } return true;
    }

    function end(res) {
        gameActive = false;
        let d = document.getElementById('diff-mode').value;
        if(res === 'win') {
            let reward = d==='hard' ? 200 : 0;
            if(d==='hard') player.wins++;
            player.coins += reward; player.exp += 100;
            confetti(); alert("‡∏ä‡∏ô‡∏∞‡πÅ‡∏•‡πâ‡∏ß! ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö " + reward + " ü™ô");
        } else alert(res==='lose' ? "‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏û‡πâ!" : "‡πÄ‡∏™‡∏°‡∏≠!");
        
        if(player.exp >= player.lvl*500) { player.lvl++; player.exp=0; player.coins+=500; addChatSys("LEVEL UP! LVL "+player.lvl); }
        updateUI(); save();
    }

    function updateUI() {
        document.getElementById('coin-txt').innerText = player.coins.toLocaleString();
        document.getElementById('lvl-txt').innerText = "LVL " + player.lvl;
        document.getElementById('exp-txt').innerText = player.exp + "/500";
        document.getElementById('exp-fill').style.width = (player.exp/5) + "%";
        
        const shop = document.getElementById('skin-shop'); shop.innerHTML = '';
        skins.forEach(s => {
            let owned = player.skins.includes(s.id);
            shop.innerHTML += `<div class="skin-card ${player.activeSkin===s.id?'active':''}" onclick="buy('${s.id}',${s.price})">
                <span class="skin-icon">${s.icon}</span>
                <span class="skin-price">${owned?'OWNED':s.price+'ü™ô'}</span>
            </div>`;
        });

        const lb = [{n:player.name, w:player.wins}, {n:'BOT_GOD', w:99}, {n:'AYU_PRO', w:45}].sort((a,b)=>b.w-a.w);
        document.getElementById('lb-content').innerHTML = lb.map((p,i)=>`<div class="lb-item"><span>${i+1}. ${p.n}</span><span>${p.w} WINS</span></div>`).join('');
    }

    function buy(id, p) {
        if(player.skins.includes(id)) player.activeSkin = id;
        else if(player.coins >= p) { player.coins -= p; player.skins.push(id); player.activeSkin = id; }
        else alert("‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÑ‡∏°‡πà‡∏û‡∏≠!");
        updateUI(); save(); render();
    }

    function sendChat() {
        let i = document.getElementById('chat-input');
        if(i.value) {
            document.getElementById('chat-content').innerHTML += `<div><b>${player.name}:</b> ${i.value}</div>`;
            i.value = ''; document.getElementById('chat-content').scrollTop = 999;
        }
    }

    function addChatSys(m) {
        document.getElementById('chat-content').innerHTML += `<div style="color:var(--gold)">[SYSTEM] ${m}</div>`;
        document.getElementById('chat-content').scrollTop = 999;
    }

    function matchmake() {
        addChatSys("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á...");
        setTimeout(() => { gameActive = true; initBoard(); addChatSys("‡πÄ‡∏à‡∏≠‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß! ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ"); }, 1000);
    }

    function save() { localStorage.setItem('ayu_final_db', JSON.stringify(player)); }
    setInterval(() => { document.getElementById('ping-val').innerText = Math.floor(Math.random()*15)+15; }, 2000);
    
    if(player.name) {
        document.getElementById('pNameInput').value = player.name;
    }
</script>
</body>
</html>
